{% extends 'html.twig' %}

{% block contents %}

{% if errors %}

    <div class="disclaimer disclaimer--red">
    <h1>Ошибка! Отправка Результатов не удалась</h1>
    <p>
    <ul>
    {% for error in errors %}
        <li>{{ error }}</li> 
    {% endfor %}
    </ul>
    <strong>
       Пожалуйста <a href="{{ url_for('survey') }}">Перезагрузите эту страницу</a>
    </strong>
    <br>
        Если ошибка по прежнему сохраняется, пожалуйста, <a href="#" class="open-results">откройте результаты,</a> и отправьте скриншот на <strong>nmarchenko97@gmail.com</strong>
        или на WhatsApp по номеру <a traget="_blank" href="https://wa.me/7923567890?text=Я%20Прошел%20тест%20"></a>
        <div class="button-wrap">
            <a href="#" class="button open-results">Показать результаты</a>
        </div>
    </p>
</div>

{% else %}
<h1>Благодарим за пройденный опрос!</h1>
    <div class="disclaimer disclaimer--green text-center">
    <p>
        Благодарим за потраченное время и интерес к прохождению опроса! Ваши результаты очень важны для нас!
    <br>
        Интерпретация результатов всех опросов будет включена в дипломную работу автора
    <br>
        Интерпретацию по уровню толерантности и оценке ваших характеристик, можете прочитать ниже. Так-же там указаны общие баллы.
    </p>
</div>
{% endif %}
    
</ul>
  <style type="text/css">
   td { 
    border: 1px solid #ccccee;
    padding: 4px 10px;
   }
   th { 
    border: 1px solid #ccccee;
    padding: 6px 14px;
    font-weight: bold;
   }
  </style>

<h4>Автоматически интерпретируемые результаты:</h4>
<div class="results">
    {% for key, methodic in questions %}
        {% if key == "Methodic 1" %}
            <h2>Методика №1 — {{ scores[key]['all'] }} баллов</h2>
            <table>
            <tr><th>{{ key }}</th><th>Всего: {{ scores[key]['all'] }} баллов</th><th>{{ scores[key]['conclusion'] }}</th></tr>
            {% for scale in methodic %}
                <tr><td>{{ scale.name }}</td><td>{{ scores[key]['scales'][scale.id]['score'] }} баллов</td><td></td></tr>
            {% endfor %}
            </table>
        {% elseif key == "Methodic 2" %}
            <h2>{{ key }} — {{ scores[key]['all'] }} баллов</h2>
            <table>
            <tr><th>{{ key }}</th><th>Всего: {{ scores[key]['all'] }} баллов</th><th>{{ scores[key]['conclusion'] }}</th></tr>
            {% for scale in methodic %}
                <tr><td>{{ scale.name }}</td><td>{{ scores[key]['scales'][scale.id]['score'] }} баллов</td><td>{{ scores[key]['scales'][scale.id]['scaleConclusion'] }}</td></tr>
            {% endfor %}
            </table>
        {% elseif key == "Methodic 6" %}
            <h2>{{ key }} — {{ scores[key]['all'] }} баллов</h2>
            <table>
            <tr><th>{{ key }}</th><th>Всего: {{ scores[key]['all'] }} баллов</th></tr>
            {% for subkey, characteristic in scores[key]['characteristics'] %}
                {% if characteristic.characteristicConclusion %}
                    <tr><td>{{ subkey }}</td><td><strong>{{ characteristic.characteristicConclusion }}</strong></td></tr>
                {% endif %}
            {% endfor %}
            </table>
        {% endif %}

    {% endfor %}
</div>
{% endblock %}
